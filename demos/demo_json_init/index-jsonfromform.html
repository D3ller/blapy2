<!DOCTYPE html>
<!-- To run the current sample code in your own environment, copy this to an html page. -->
<html>
<head>
	<title>Json Example</title>
	<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
	<link rel="stylesheet" href="main.css" />
</head>
<body id="myBlapy">
	<h1>Blapy demos using json data (2)</h1>
	<p>Form calls pure json and "results" block is updated with the "data-blapy-embedding-blockid" feature</p>
	<p>Other demos:
		<ul>
			<li><a href="index.html">Update "results" block with standard Blapy blocks with json inside</a></li>
			<li><a href="index-purejson.html">Update of "results" block using "updateBlock" blapy event</a></li>
		</ul>
	</p>
	<h1>Select values with the json feature of Blapy </h1>
	<p>Fill the following form:</p>
	<form id="myForm"
				action="testForm.php?pureJson=1"
				data-blapy-link
				method="POST"
				data-blapy-embedding-blockid="results">
		Choose a firstname:
		<span
			id="fnameOptionsFirstName"
			data-blapy-container="true"
			data-blapy-container-name="fnameOptions"
			data-blapy-container-content="fnameOptionsFirstName"
			data-blapy-update="json"
			data-blapy-template-file="optionsTemplate.tpl"
			data-blapy-template-wrap="<select name=&quot;firstname&quot; onChange=&quot;submitBlapyForm('myForm');&quot;>"
		>
		</span>
		<br>
		Choose a lastname:
		<span
			id="fnameOptionsLastName"
			data-blapy-container="true"
			data-blapy-container-name="fnameOptions"
			data-blapy-container-content="fnameOptionsLastName"
			data-blapy-update="json"
			data-blapy-template-init="optionvalues.json"
		>
			<input name="lastname" type="radio" value="${lastname}" ${selected} onClick="submitBlapyForm('myForm');">${lastname}</input>
		</span>
	</form>

	<h1>Blapy Block results in a Table</h1>
	<div id="results"
			data-blapy-container="true"
			data-blapy-container-name="results"
			data-blapy-container-content="results"
			data-blapy-update="json"
			data-blapy-template-file="arrayvalues.tpl"
			data-blapy-template-wrap="<table>"
			data-blapy-template-init="arrayvalues.data"
			data-blapy-template-init-purejson="1"
		>
	</div>
</body>

    <script src="../../lib/jquery/jquery-3.7.1.min.js"></script>
    <script src="../../lib/mustache/mustache.js"></script>
    <script src="../../lib/navigo/index.js"></script>
    <script src="../../lib/iFSM/extlib/jquery.attrchange.js"></script>
    <script src="../../lib/iFSM/extlib/jquery.dotimeout.js"></script>
    <script src="../../lib/json5/index.min.js"></script>
    <script src="../../lib/iFSM/iFSM.js"></script>
    <script type="text/javascript" src="../../lib/json2html/json2html.js"></script>

<script src="../../dist/blapy2.js"></script>
<script>
        document.addEventListener("DOMContentLoaded", () => {
			let blapy = document.querySelector("#myBlapy");

			blapy.Blapy({
				logLevel: 2,
				debug: true
			});
		});

		window.submitBlapyForm = function(formId) {
    		document.getElementById(formId).dispatchEvent(new Event('submit', {bubbles: true, cancelable: true}));
		}

				const h3 = document.createElement('h3')
				h3.textContent = 'HTML code of the page'

				const pre = document.createElement('pre')
				pre.textContent = document.documentElement.outerHTML

				document.body.appendChild(h3)
				document.body.appendChild(pre)
</script>

</html>
